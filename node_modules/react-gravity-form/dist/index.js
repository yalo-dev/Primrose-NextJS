"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"FormConfirmation",{enumerable:!0,get:function get(){return _FormElements.FormConfirmation}}),Object.defineProperty(exports,"FormError",{enumerable:!0,get:function get(){return _FormElements.FormError}}),Object.defineProperty(exports,"RenderFields",{enumerable:!0,get:function get(){return _FormElements.RenderFields}}),Object.defineProperty(exports,"Submit",{enumerable:!0,get:function get(){return _FormElements.Submit}}),Object.defineProperty(exports,"validateField",{enumerable:!0,get:function get(){return _validation.validateField}}),exports["default"]=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_react=_interopRequireWildcard(require("react")),_isomorphicUnfetch=_interopRequireDefault(require("isomorphic-unfetch")),_FormElements=require("./FormElements"),_form=require("./Helpers/form"),_validation=require("./Helpers/validation");function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){(0,_defineProperty2["default"])(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}var GravityForm=function(a){var b,c=a.initialPage,d=a.populatedEntry,e=a.onChange,f=(0,_react.useState)(!1),g=(0,_slicedToArray2["default"])(f,2),h=g[0],i=g[1],j=(0,_react.useState)(!1),k=(0,_slicedToArray2["default"])(j,2),l=k[0],m=k[1],n=(0,_react.useState)({}),o=(0,_slicedToArray2["default"])(n,2),p=o[0],q=o[1],r=(0,_react.useState)(!1),s=(0,_slicedToArray2["default"])(r,2),t=s[0],u=s[1],v=(0,_react.useState)(!1),w=(0,_slicedToArray2["default"])(v,2),x=w[0],y=w[1],z=(0,_react.useState)(!1),A=(0,_slicedToArray2["default"])(z,2),B=A[0],C=A[1],D=(0,_react.useState)({}),E=(0,_slicedToArray2["default"])(D,2),F=E[0],G=E[1],H=(0,_react.useState)({}),I=(0,_slicedToArray2["default"])(H,2),J=I[0],K=I[1],L=(0,_react.useState)(c||1),M=(0,_slicedToArray2["default"])(L,2),N=M[0],O=M[1],P=(0,_react.useState)({}),Q=(0,_slicedToArray2["default"])(P,2),R=Q[0],S=Q[1],T=(0,_react.useState)({}),U=(0,_slicedToArray2["default"])(T,2),V=U[0],W=U[1],X=(0,_react.useState)(!1),Y=(0,_slicedToArray2["default"])(X,2),Z=Y[0],$=Y[1],_=(0,_react.useState)(!1),aa=(0,_slicedToArray2["default"])(_,2),ba=aa[0],ca=aa[1],da=(0,_react.useState)(!1),ea=(0,_slicedToArray2["default"])(da,2),fa=ea[0],ga=ea[1],ha=(0,_react.useState)({}),ia=(0,_slicedToArray2["default"])(ha,2),ja=ia[0],ka=ia[1],la=(0,_react.useRef)(null),ma=(0,_react.useCallback)(function(a){(0,_form.updateFieldsValuesBasedOnEntry)(a)},[]);(0,_react.useEffect)(function(){(0,_form.fetchForm)(_objectSpread({setFormData:G,setFormValues:q,setActivePage:O,setConditionFields:S,setConditionalIds:W,setPages:ka,setIsMultiPart:$},a))},[]),(0,_react.useEffect)(function(){e&&e(p)},[p]),(0,_react.useEffect)(function(){d&&ma(d)},[d]);var na=function(){if(la){var a=la.current.querySelector(".form-field.error");a&&a.scrollIntoView()}},oa=a.title,pa=a.formID,qa=a.submitIcon,ra=a.saveStateToHtmlField,sa=a.styledComponents,ta=a.customComponents,ua=a.errorMessage,va=a.dropzoneText,wa=a.loadingSpinner,xa=a.onError,ya=a.language,za=a.apiKeys,Aa=sa||!1,Ba=Aa.Button,Ca=Aa.Loading,Da=Aa.FormError,Ea=Aa.FormConfirmation,Fa=Aa.GFWrapper,Ga=void 0===Fa?"div":Fa,Ha=F||{},Ia=Ha.cssClass,Ja=Ha.button;Ja=void 0===Ja?{}:Ja;var Ka=Ja.conditionalLogic,La=Ka&&(0,_form.checkConditionalLogic)(Ka,0<Object.keys(p).length?p:F.fields),Ma=function(a){a.preventDefault(),(0,_form.prevStep)(p,ja,N,O,ca)},Na=function(){var b=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function b(c){var d,e,f,g,h,j,k,l,n,o;return _regenerator["default"].wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(d=a.onSubmit,e=a.filterFormData,f=new FormData(c.target),e&&(f=e(f,p)),c.preventDefault(),g=(0,_form.forceValidation)(N,p,ga,K),g){b.next=8;break}return na(),b.abrupt("return",!1);case 8:d?d(f):(u(!0),y(!1),i(!1),C(!1),m(!1),h=a.formID,j=a.backendUrl,k=a.jumpToConfirmation,l=a.onSubmitSuccess,n=a.onError,o=j.substring(0,j.indexOf("/wp-json")),(0,_isomorphicUnfetch["default"])("".concat(o,"/wp-json/gf/v2/forms/").concat(h,"/submissions"),{method:"POST",body:f}).then(function(a){return a.json()}).then(function(b){if(b&&b.is_valid){if(l){var g=l(b);if(!g)return!1}var c=b.confirmation_message,d=c||!1,e=d.type,f=d.link;if(e&&f&&"redirect"===e&&"undefined"!=typeof window)return window.location.replace(f),!1;u(!1),y(!0),C(c),k&&(0,_form.scrollToConfirmation)(a,la,k)}else throw{response:b}})["catch"](function(b){var c=b&&b.response&&b.response.validation_messages?b.response.validation_messages:"Something went wrong";n?(n(c),u(!1),i(!0)):(u(!1),i(!0),m(c)),k&&(0,_form.scrollToConfirmation)(a,la)}));case 9:case"end":return b.stop();}},b)}));return function onSubmit(){return b.apply(this,arguments)}}();return _react["default"].createElement(Ga,{ref:la,className:"form-wrapper",id:"gravity_form_".concat(pa)},F.title?null:Ca&&_react["default"].createElement(Ca,{isLoading:!0}),h&&!x&&!xa&&_react["default"].createElement(_FormElements.FormError,{SFormError:Da||!1,errorMessage:ua||"There was a problem with your submission"}),x&&B&&_react["default"].createElement(_FormElements.FormConfirmation,{confirmation:B,SFormConfirmation:Ea}),!x&&F.fields?_react["default"].createElement("form",{onSubmit:function onSubmit(a){return Na(a)},className:Ia,encType:Z?"multipart/form-data":void 0,noValidate:!0},(F.title||F.description)&&_react["default"].createElement("div",null,F.title&&oa?_react["default"].createElement("h3",{className:"form-title"},F.title):null,F.description?_react["default"].createElement("p",{className:"form-description"},F.description):null),_react["default"].createElement("div",{className:"form-wrapper"},(null===F||void 0===F||null===(b=F.pagination)||void 0===b?void 0:b.pages)&&_react["default"].createElement(_FormElements.ProgressBar,{pagination:F.pagination,activePage:N,firstPageCssClass:F.firstPageCssClass}),_react["default"].createElement(_FormElements.RenderFields,(0,_extends2["default"])({styledComponents:sa,customComponents:ta,fields:F.fields,formValues:p,submitFailed:h,submitSuccess:x,updateForm:function updateForm(a,b,c){return(0,_form.updateFormHandler)(b,a,c,p,q,V,R)},touched:J,setTouched:function setTouched(a){return(0,_form.setTouchedHandler)(a,J,K)},setErrorMessages:m,pagination:F.pagination,activePage:N,prevStep:function prevStep(a){return Ma(a)},nextStep:function nextStep(b){return(0,_form.nextStep)(b,a,ja,p,N,O,ca,K,ga)},checkConditionalLogic:function checkConditionalLogic(a,b){return(0,_form.checkConditionalLogic)(a,b=!1)},saveStateToHtmlField:ra,enableHoneypot:F.enableHoneypot,errors:l,unsetError:function unsetError(a){return(0,_form.unsetError)(a,l)},dropzoneText:va,pageClicked:ba,language:ya,apiKeys:za},a)),(!F.pagination||F.pagination&&F.pagination.pages.length===N)&&_react["default"].createElement(_FormElements.Submit,{Button:Ba,Loading:Ca,formData:F,submitIcon:qa,submitting:t,prevStep:function prevStep(a){return Ma(a)},loadingSpinner:wa,hideSubmitButton:La}))):"")};GravityForm.defaultProps={title:!0,submitIcon:!1,saveStateToHtmlField:!1,jumpToConfirmation:!0};var _default=GravityForm;exports["default"]=_default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJHcmF2aXR5Rm9ybSIsInByb3BzIiwiaW5pdGlhbFBhZ2UiLCJwb3B1bGF0ZWRFbnRyeSIsIm9uQ2hhbmdlIiwic3VibWl0RmFpbGVkIiwic2V0U3VibWl0RmFpbGVkIiwiZXJyb3JNZXNzYWdlcyIsInNldEVycm9yTWVzc2FnZXMiLCJmb3JtVmFsdWVzIiwic2V0Rm9ybVZhbHVlcyIsInN1Ym1pdHRpbmciLCJzZXRTdWJtaXR0aW5nIiwic3VibWl0U3VjY2VzcyIsInNldFN1Ym1pdFN1Y2Nlc3MiLCJjb25maXJtYXRpb25NZXNzYWdlIiwic2V0Q29uZmlybWF0aW9uTWVzc2FnZSIsImZvcm1EYXRhIiwic2V0Rm9ybURhdGEiLCJ0b3VjaGVkIiwic2V0VG91Y2hlZCIsImFjdGl2ZVBhZ2UiLCJzZXRBY3RpdmVQYWdlIiwiY29uZGl0aW9uRmllbGRzIiwic2V0Q29uZGl0aW9uRmllbGRzIiwiY29uZGl0aW9uYWxJZHMiLCJzZXRDb25kaXRpb25hbElkcyIsImlzTXVsdGlwYXJ0Iiwic2V0SXNNdWx0aVBhcnQiLCJwYWdlQ2xpY2tlZCIsInNldFBhZ2VDbGlja2VkIiwic2hvd1BhZ2VWYWxpZGF0aW9uTXNnIiwic2V0U2hvd1BhZ2VWYWxpZGF0aW9uTXNnIiwicGFnZXMiLCJzZXRQYWdlcyIsIndyYXBwZXJSZWYiLCJ1cGRhdGVFbnRyeUZpZWxkcyIsInNjcm9sbFRvRmlyc3RJbnZhbGlkRmllbGQiLCJmaXJzdEVyckVsIiwiY3VycmVudCIsInF1ZXJ5U2VsZWN0b3IiLCJzY3JvbGxJbnRvVmlldyIsInRpdGxlIiwiZm9ybUlEIiwic3VibWl0SWNvbiIsInNhdmVTdGF0ZVRvSHRtbEZpZWxkIiwic3R5bGVkQ29tcG9uZW50cyIsImN1c3RvbUNvbXBvbmVudHMiLCJlcnJvck1lc3NhZ2UiLCJkcm9wem9uZVRleHQiLCJsb2FkaW5nU3Bpbm5lciIsIm9uRXJyb3IiLCJsYW5ndWFnZSIsImFwaUtleXMiLCJCdXR0b24iLCJMb2FkaW5nIiwiU0Zvcm1FcnJvciIsIkZvcm1FcnJvciIsIlNGb3JtQ29uZmlybWF0aW9uIiwiRm9ybUNvbmZpcm1hdGlvbiIsIkdGV3JhcHBlciIsImNzc0NsYXNzIiwiYnV0dG9uIiwiY29uZGl0aW9uYWxMb2dpYyIsImhpZGVTdWJtaXRCdXR0b24iLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwiZmllbGRzIiwiaGFuZGxlUHJldlN0ZXAiLCJlIiwicHJldmVudERlZmF1bHQiLCJvblN1Ym1pdCIsImV2ZW50IiwiY3VzdG9tT25TdWJtaXQiLCJmaWx0ZXJGb3JtRGF0YSIsIkZvcm1EYXRhIiwidGFyZ2V0IiwiaXNGb3JtVmFsaWQiLCJiYWNrZW5kVXJsIiwianVtcFRvQ29uZmlybWF0aW9uIiwib25TdWJtaXRTdWNjZXNzIiwiZ2ZTdWJtaXNzaW9uVXJsIiwic3Vic3RyaW5nIiwiaW5kZXhPZiIsIm1ldGhvZCIsImJvZHkiLCJ0aGVuIiwicmVzcCIsImpzb24iLCJyZXNwb25zZSIsImlzX3ZhbGlkIiwicmVzIiwiY29uZmlybWF0aW9uX21lc3NhZ2UiLCJ0eXBlIiwibGluayIsIndpbmRvdyIsImxvY2F0aW9uIiwicmVwbGFjZSIsImVycm9yIiwidmFsaWRhdGlvbl9tZXNzYWdlcyIsImRlc2NyaXB0aW9uIiwicGFnaW5hdGlvbiIsImZpcnN0UGFnZUNzc0NsYXNzIiwiZmllbGQiLCJpbnB1dElEIiwiaWQiLCJjb25kaXRpb24iLCJlbmFibGVIb25leXBvdCIsImRlZmF1bHRQcm9wcyJdLCJtYXBwaW5ncyI6InVrRUFtQkEsR0FBTUEsQ0FBQUEsV0FBVyxDQUFHLFNBQUFDLENBQUssQ0FBSSxPQUNuQkMsQ0FEbUIsQ0FDdUJELENBRHZCLENBQ25CQyxXQURtQixDQUNOQyxDQURNLENBQ3VCRixDQUR2QixDQUNORSxjQURNLENBQ1VDLENBRFYsQ0FDdUJILENBRHZCLENBQ1VHLFFBRFYsR0FHYSx1QkFIYix1Q0FHcEJDLENBSG9CLE1BR05DLENBSE0sUUFJZSx1QkFKZix1Q0FJcEJDLENB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ZWFjdCwgeyB1c2VFZmZlY3QsIHVzZVN0YXRlLCB1c2VDYWxsYmFjaywgdXNlUmVmIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IGZldGNoIGZyb20gJ2lzb21vcnBoaWMtdW5mZXRjaCc7XG5pbXBvcnQgeyBGb3JtQ29uZmlybWF0aW9uLCBGb3JtRXJyb3IsIFJlbmRlckZpZWxkcywgU3VibWl0LCBQcm9ncmVzc0JhciB9IGZyb20gJy4vRm9ybUVsZW1lbnRzJztcblxuaW1wb3J0IHtcbiAgY2hlY2tDb25kaXRpb25hbExvZ2ljLFxuICBmZXRjaEZvcm0sXG4gIGZvcmNlVmFsaWRhdGlvbixcbiAgbmV4dFN0ZXAsXG4gIHByZXZTdGVwLFxuICBzY3JvbGxUb0NvbmZpcm1hdGlvbixcbiAgc2V0VG91Y2hlZEhhbmRsZXIsXG4gIHVuc2V0RXJyb3IsXG4gIHVwZGF0ZUZpZWxkc1ZhbHVlc0Jhc2VkT25FbnRyeSxcbiAgdXBkYXRlRm9ybUhhbmRsZXIsXG59IGZyb20gJy4vSGVscGVycy9mb3JtJztcblxuaW1wb3J0IHsgdmFsaWRhdGVGaWVsZCB9IGZyb20gJy4vSGVscGVycy92YWxpZGF0aW9uJztcblxuY29uc3QgR3Jhdml0eUZvcm0gPSBwcm9wcyA9PiB7XG4gIGNvbnN0IHsgaW5pdGlhbFBhZ2UsIHBvcHVsYXRlZEVudHJ5LCBvbkNoYW5nZSB9ID0gcHJvcHM7XG5cbiAgY29uc3QgW3N1Ym1pdEZhaWxlZCwgc2V0U3VibWl0RmFpbGVkXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2Vycm9yTWVzc2FnZXMsIHNldEVycm9yTWVzc2FnZXNdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbZm9ybVZhbHVlcywgc2V0Rm9ybVZhbHVlc10gPSB1c2VTdGF0ZSh7fSk7XG4gIGNvbnN0IFtzdWJtaXR0aW5nLCBzZXRTdWJtaXR0aW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW3N1Ym1pdFN1Y2Nlc3MsIHNldFN1Ym1pdFN1Y2Nlc3NdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbY29uZmlybWF0aW9uTWVzc2FnZSwgc2V0Q29uZmlybWF0aW9uTWVzc2FnZV0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtmb3JtRGF0YSwgc2V0Rm9ybURhdGFdID0gdXNlU3RhdGUoe30pO1xuICBjb25zdCBbdG91Y2hlZCwgc2V0VG91Y2hlZF0gPSB1c2VTdGF0ZSh7fSk7XG4gIGNvbnN0IFthY3RpdmVQYWdlLCBzZXRBY3RpdmVQYWdlXSA9IHVzZVN0YXRlKGluaXRpYWxQYWdlIHx8IDEpO1xuICBjb25zdCBbY29uZGl0aW9uRmllbGRzLCBzZXRDb25kaXRpb25GaWVsZHNdID0gdXNlU3RhdGUoe30pO1xuICBjb25zdCBbY29uZGl0aW9uYWxJZHMsIHNldENvbmRpdGlvbmFsSWRzXSA9IHVzZVN0YXRlKHt9KTtcbiAgY29uc3QgW2lzTXVsdGlwYXJ0LCBzZXRJc011bHRpUGFydF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtwYWdlQ2xpY2tlZCwgc2V0UGFnZUNsaWNrZWRdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbc2hvd1BhZ2VWYWxpZGF0aW9uTXNnLCBzZXRTaG93UGFnZVZhbGlkYXRpb25Nc2ddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbcGFnZXMsIHNldFBhZ2VzXSA9IHVzZVN0YXRlKHt9KTtcblxuICBjb25zdCB3cmFwcGVyUmVmID0gdXNlUmVmKG51bGwpO1xuXG4gIGNvbnN0IHVwZGF0ZUVudHJ5RmllbGRzID0gdXNlQ2FsbGJhY2socG9wdWxhdGVkRW50cnkgPT4ge1xuICAgIHVwZGF0ZUZpZWxkc1ZhbHVlc0Jhc2VkT25FbnRyeShwb3B1bGF0ZWRFbnRyeSk7XG4gIH0sIFtdKTtcblxuICAvKipcbiAgICogRmV0Y2ggZm9ybSBkYXRhXG4gICAqL1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGZldGNoRm9ybSh7XG4gICAgICBzZXRGb3JtRGF0YSxcbiAgICAgIHNldEZvcm1WYWx1ZXMsXG4gICAgICBzZXRBY3RpdmVQYWdlLFxuICAgICAgc2V0Q29uZGl0aW9uRmllbGRzLFxuICAgICAgc2V0Q29uZGl0aW9uYWxJZHMsXG4gICAgICBzZXRQYWdlcyxcbiAgICAgIHNldElzTXVsdGlQYXJ0LFxuICAgICAgLi4ucHJvcHMsXG4gICAgfSk7XG4gIH0sIFtdKTtcblxuICAvKipcbiAgICogQ2FsbCBjdXN0b20gb25DaGFuZ2UgaGFuZGxlciB3aXRoIHBhc3NlZCB2YWx1ZXMgZnJvbSBmb3JtXG4gICAqL1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChvbkNoYW5nZSkge1xuICAgICAgb25DaGFuZ2UoZm9ybVZhbHVlcyk7XG4gICAgfVxuICB9LCBbZm9ybVZhbHVlc10pO1xuXG4gIC8qKlxuICAgKiBTZXQgZW50cnkgdG8gdGhlIGZvcm1cbiAgICovXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHBvcHVsYXRlZEVudHJ5KSB7XG4gICAgICB1cGRhdGVFbnRyeUZpZWxkcyhwb3B1bGF0ZWRFbnRyeSk7XG4gICAgfVxuICB9LCBbcG9wdWxhdGVkRW50cnldKTtcblxuICAvKipcbiAgICogU2Nyb2xsIHBhZ2UgdG8gdGhlIGZpcnN0IG5vdCB2YWxpZCBmaWVsZFxuICAgKi9cbiAgY29uc3Qgc2Nyb2xsVG9GaXJzdEludmFsaWRGaWVsZCA9ICgpID0+IHtcbiAgICBpZiAoIXdyYXBwZXJSZWYpIHJldHVybjtcblxuICAgIGNvbnN0IGZpcnN0RXJyRWwgPSB3cmFwcGVyUmVmLmN1cnJlbnQucXVlcnlTZWxlY3RvcignLmZvcm0tZmllbGQuZXJyb3InKTtcbiAgICBpZiAoZmlyc3RFcnJFbCkge1xuICAgICAgZmlyc3RFcnJFbC5zY3JvbGxJbnRvVmlldygpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCB7XG4gICAgdGl0bGUsXG4gICAgZm9ybUlELFxuICAgIHN1Ym1pdEljb24sXG4gICAgc2F2ZVN0YXRlVG9IdG1sRmllbGQsXG4gICAgc3R5bGVkQ29tcG9uZW50cyxcbiAgICBjdXN0b21Db21wb25lbnRzLFxuICAgIGVycm9yTWVzc2FnZSxcbiAgICBkcm9wem9uZVRleHQsXG4gICAgbG9hZGluZ1NwaW5uZXIsXG4gICAgb25FcnJvcixcbiAgICBsYW5ndWFnZSxcbiAgICBhcGlLZXlzLFxuICB9ID0gcHJvcHM7XG5cbiAgY29uc3Qge1xuICAgIEJ1dHRvbixcbiAgICBMb2FkaW5nLFxuICAgIEZvcm1FcnJvcjogU0Zvcm1FcnJvcixcbiAgICBGb3JtQ29uZmlybWF0aW9uOiBTRm9ybUNvbmZpcm1hdGlvbixcbiAgICBHRldyYXBwZXIgPSAnZGl2JyxcbiAgfSA9IHN0eWxlZENvbXBvbmVudHMgfHwgZmFsc2U7XG5cbiAgY29uc3QgeyBjc3NDbGFzcywgYnV0dG9uOiB7IGNvbmRpdGlvbmFsTG9naWMgfSA9IHt9IH0gPSBmb3JtRGF0YSB8fCB7fTtcbiAgY29uc3QgaGlkZVN1Ym1pdEJ1dHRvbiA9XG4gIGNvbmRpdGlvbmFsTG9naWMgJiZcbiAgY2hlY2tDb25kaXRpb25hbExvZ2ljKFxuICAgIGNvbmRpdGlvbmFsTG9naWMsXG4gICAgT2JqZWN0LmtleXMoZm9ybVZhbHVlcykubGVuZ3RoID4gMCA/IGZvcm1WYWx1ZXMgOiBmb3JtRGF0YS5maWVsZHNcbiAgKTtcblxuICBjb25zdCBoYW5kbGVQcmV2U3RlcCA9IGUgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBwcmV2U3RlcChmb3JtVmFsdWVzLCBwYWdlcywgYWN0aXZlUGFnZSwgc2V0QWN0aXZlUGFnZSwgc2V0UGFnZUNsaWNrZWQpO1xuICB9O1xuXG4gIGNvbnN0IG9uU3VibWl0ID0gYXN5bmMgZXZlbnQgPT4ge1xuICAgIGNvbnN0IHsgb25TdWJtaXQ6IGN1c3RvbU9uU3VibWl0LCBmaWx0ZXJGb3JtRGF0YSB9ID0gcHJvcHM7XG4gICAgbGV0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKGV2ZW50LnRhcmdldCk7XG5cbiAgICBpZiAoZmlsdGVyRm9ybURhdGEpIGZvcm1EYXRhID0gZmlsdGVyRm9ybURhdGEoZm9ybURhdGEsIGZvcm1WYWx1ZXMpO1xuXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgIGNvbnN0IGlzRm9ybVZhbGlkID0gZm9yY2VWYWxpZGF0aW9uKFxuICAgICAgYWN0aXZlUGFnZSxcbiAgICAgIGZvcm1WYWx1ZXMsXG4gICAgICBzZXRTaG93UGFnZVZhbGlkYXRpb25Nc2csXG4gICAgICBzZXRUb3VjaGVkXG4gICAgKTtcblxuICAgIGlmICghaXNGb3JtVmFsaWQpIHtcbiAgICAgIHNjcm9sbFRvRmlyc3RJbnZhbGlkRmllbGQoKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoY3VzdG9tT25TdWJtaXQpIHtcbiAgICAgIGN1c3RvbU9uU3VibWl0KGZvcm1EYXRhKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2V0U3VibWl0dGluZyh0cnVlKTtcbiAgICAgIHNldFN1Ym1pdFN1Y2Nlc3MoZmFsc2UpO1xuICAgICAgc2V0U3VibWl0RmFpbGVkKGZhbHNlKTtcbiAgICAgIHNldENvbmZpcm1hdGlvbk1lc3NhZ2UoZmFsc2UpO1xuICAgICAgc2V0RXJyb3JNZXNzYWdlcyhmYWxzZSk7XG5cbiAgICAgIGNvbnN0IHsgZm9ybUlELCBiYWNrZW5kVXJsLCBqdW1wVG9Db25maXJtYXRpb24sIG9uU3VibWl0U3VjY2Vzcywgb25FcnJvciB9ID0gcHJvcHM7XG4gICAgICBjb25zdCBnZlN1Ym1pc3Npb25VcmwgPSBiYWNrZW5kVXJsLnN1YnN0cmluZygwLCBiYWNrZW5kVXJsLmluZGV4T2YoJy93cC1qc29uJykpO1xuXG4gICAgICBmZXRjaChgJHtnZlN1Ym1pc3Npb25Vcmx9L3dwLWpzb24vZ2YvdjIvZm9ybXMvJHtmb3JtSUR9L3N1Ym1pc3Npb25zYCwge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgYm9keTogZm9ybURhdGEsXG4gICAgICB9KVxuICAgICAgICAudGhlbihyZXNwID0+IHJlc3AuanNvbigpKVxuICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICBpZiAob25TdWJtaXRTdWNjZXNzKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHJlcyA9IG9uU3VibWl0U3VjY2VzcyhyZXNwb25zZSk7XG4gICAgICAgICAgICAgIGlmICghcmVzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBjb25maXJtYXRpb25NZXNzYWdlID0gcmVzcG9uc2UuY29uZmlybWF0aW9uX21lc3NhZ2U7XG4gICAgICAgICAgICBjb25zdCB7IHR5cGUsIGxpbmsgfSA9IGNvbmZpcm1hdGlvbk1lc3NhZ2UgfHwgZmFsc2U7XG4gICAgICAgICAgICBpZiAodHlwZSAmJiBsaW5rICYmIHR5cGUgPT09ICdyZWRpcmVjdCcpIHtcbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UobGluayk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZXRTdWJtaXR0aW5nKGZhbHNlKTtcbiAgICAgICAgICAgIHNldFN1Ym1pdFN1Y2Nlc3ModHJ1ZSk7XG4gICAgICAgICAgICBzZXRDb25maXJtYXRpb25NZXNzYWdlKGNvbmZpcm1hdGlvbk1lc3NhZ2UpO1xuXG4gICAgICAgICAgICBpZiAoanVtcFRvQ29uZmlybWF0aW9uKSB7XG4gICAgICAgICAgICAgIHNjcm9sbFRvQ29uZmlybWF0aW9uKHByb3BzLCB3cmFwcGVyUmVmLCBqdW1wVG9Db25maXJtYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyB7XG4gICAgICAgICAgICAgIHJlc3BvbnNlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlcyA9XG4gICAgICAgICAgICBlcnJvciAmJiBlcnJvci5yZXNwb25zZSAmJiBlcnJvci5yZXNwb25zZS52YWxpZGF0aW9uX21lc3NhZ2VzXG4gICAgICAgICAgICAgID8gZXJyb3IucmVzcG9uc2UudmFsaWRhdGlvbl9tZXNzYWdlc1xuICAgICAgICAgICAgICA6ICdTb21ldGhpbmcgd2VudCB3cm9uZyc7XG5cbiAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgb25FcnJvcihlcnJvck1lc3NhZ2VzKTtcbiAgICAgICAgICAgIHNldFN1Ym1pdHRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgc2V0U3VibWl0RmFpbGVkKHRydWUpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXRTdWJtaXR0aW5nKGZhbHNlKTtcbiAgICAgICAgICAgIHNldFN1Ym1pdEZhaWxlZCh0cnVlKTtcbiAgICAgICAgICAgIHNldEVycm9yTWVzc2FnZXMoZXJyb3JNZXNzYWdlcyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGp1bXBUb0NvbmZpcm1hdGlvbikge1xuICAgICAgICAgICAgc2Nyb2xsVG9Db25maXJtYXRpb24ocHJvcHMsIHdyYXBwZXJSZWYpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPEdGV3JhcHBlciByZWY9e3dyYXBwZXJSZWZ9IGNsYXNzTmFtZT1cImZvcm0td3JhcHBlclwiIGlkPXtgZ3Jhdml0eV9mb3JtXyR7Zm9ybUlEfWB9PlxuICAgICAge2Zvcm1EYXRhLnRpdGxlID8gbnVsbCA6IExvYWRpbmcgJiYgPExvYWRpbmcgaXNMb2FkaW5nIC8+fVxuXG4gICAgICB7c3VibWl0RmFpbGVkICYmICFzdWJtaXRTdWNjZXNzICYmICFvbkVycm9yICYmIChcbiAgICAgICAgPEZvcm1FcnJvclxuICAgICAgICAgIFNGb3JtRXJyb3I9e1NGb3JtRXJyb3IgfHwgZmFsc2V9XG4gICAgICAgICAgZXJyb3JNZXNzYWdlPXtlcnJvck1lc3NhZ2UgfHwgJ1RoZXJlIHdhcyBhIHByb2JsZW0gd2l0aCB5b3VyIHN1Ym1pc3Npb24nfVxuICAgICAgICAvPlxuICAgICAgKX1cblxuICAgICAge3N1Ym1pdFN1Y2Nlc3MgJiYgY29uZmlybWF0aW9uTWVzc2FnZSAmJiAoXG4gICAgICAgIDxGb3JtQ29uZmlybWF0aW9uXG4gICAgICAgICAgY29uZmlybWF0aW9uPXtjb25maXJtYXRpb25NZXNzYWdlfVxuICAgICAgICAgIFNGb3JtQ29uZmlybWF0aW9uPXtTRm9ybUNvbmZpcm1hdGlvbn1cbiAgICAgICAgLz5cbiAgICAgICl9XG5cbiAgICAgIHshc3VibWl0U3VjY2VzcyAmJiBmb3JtRGF0YS5maWVsZHMgPyAoXG4gICAgICAgIDxmb3JtXG4gICAgICAgICAgb25TdWJtaXQ9e2V2ZW50ID0+IG9uU3VibWl0KGV2ZW50KX1cbiAgICAgICAgICBjbGFzc05hbWU9e2Nzc0NsYXNzfVxuICAgICAgICAgIGVuY1R5cGU9e2lzTXVsdGlwYXJ0ID8gJ211bHRpcGFydC9mb3JtLWRhdGEnIDogdW5kZWZpbmVkfVxuICAgICAgICAgIG5vVmFsaWRhdGVcbiAgICAgICAgPlxuICAgICAgICAgIHsoZm9ybURhdGEudGl0bGUgfHwgZm9ybURhdGEuZGVzY3JpcHRpb24pICYmIChcbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIHtmb3JtRGF0YS50aXRsZSAmJiB0aXRsZSA/IDxoMyBjbGFzc05hbWU9XCJmb3JtLXRpdGxlXCI+e2Zvcm1EYXRhLnRpdGxlfTwvaDM+IDogbnVsbH1cbiAgICAgICAgICAgICAge2Zvcm1EYXRhLmRlc2NyaXB0aW9uID8gKFxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImZvcm0tZGVzY3JpcHRpb25cIj57Zm9ybURhdGEuZGVzY3JpcHRpb259PC9wPlxuICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICl9XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmb3JtLXdyYXBwZXJcIj5cbiAgICAgICAgICAgIHtmb3JtRGF0YT8ucGFnaW5hdGlvbj8ucGFnZXMgJiYgKFxuICAgICAgICAgICAgICA8UHJvZ3Jlc3NCYXJcbiAgICAgICAgICAgICAgICBwYWdpbmF0aW9uPXtmb3JtRGF0YS5wYWdpbmF0aW9ufVxuICAgICAgICAgICAgICAgIGFjdGl2ZVBhZ2U9e2FjdGl2ZVBhZ2V9XG4gICAgICAgICAgICAgICAgZmlyc3RQYWdlQ3NzQ2xhc3M9e2Zvcm1EYXRhLmZpcnN0UGFnZUNzc0NsYXNzfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDxSZW5kZXJGaWVsZHNcbiAgICAgICAgICAgICAgc3R5bGVkQ29tcG9uZW50cz17c3R5bGVkQ29tcG9uZW50c31cbiAgICAgICAgICAgICAgY3VzdG9tQ29tcG9uZW50cz17Y3VzdG9tQ29tcG9uZW50c31cbiAgICAgICAgICAgICAgZmllbGRzPXtmb3JtRGF0YS5maWVsZHN9XG4gICAgICAgICAgICAgIGZvcm1WYWx1ZXM9e2Zvcm1WYWx1ZXN9XG4gICAgICAgICAgICAgIHN1Ym1pdEZhaWxlZD17c3VibWl0RmFpbGVkfVxuICAgICAgICAgICAgICBzdWJtaXRTdWNjZXNzPXtzdWJtaXRTdWNjZXNzfVxuICAgICAgICAgICAgICB1cGRhdGVGb3JtPXsoZXZlbnQsIGZpZWxkLCBpbnB1dElEKSA9PlxuICAgICAgICAgICAgICAgIHVwZGF0ZUZvcm1IYW5kbGVyKFxuICAgICAgICAgICAgICAgICAgZmllbGQsXG4gICAgICAgICAgICAgICAgICBldmVudCxcbiAgICAgICAgICAgICAgICAgIGlucHV0SUQsXG4gICAgICAgICAgICAgICAgICBmb3JtVmFsdWVzLFxuICAgICAgICAgICAgICAgICAgc2V0Rm9ybVZhbHVlcyxcbiAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbmFsSWRzLFxuICAgICAgICAgICAgICAgICAgY29uZGl0aW9uRmllbGRzXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHRvdWNoZWQ9e3RvdWNoZWR9XG4gICAgICAgICAgICAgIHNldFRvdWNoZWQ9e2lkID0+IHNldFRvdWNoZWRIYW5kbGVyKGlkLCB0b3VjaGVkLCBzZXRUb3VjaGVkKX1cbiAgICAgICAgICAgICAgc2V0RXJyb3JNZXNzYWdlcz17c2V0RXJyb3JNZXNzYWdlc31cbiAgICAgICAgICAgICAgcGFnaW5hdGlvbj17Zm9ybURhdGEucGFnaW5hdGlvbn1cbiAgICAgICAgICAgICAgYWN0aXZlUGFnZT17YWN0aXZlUGFnZX1cbiAgICAgICAgICAgICAgcHJldlN0ZXA9e2UgPT4gaGFuZGxlUHJldlN0ZXAoZSl9XG4gICAgICAgICAgICAgIG5leHRTdGVwPXtlID0+XG4gICAgICAgICAgICAgICAgbmV4dFN0ZXAoXG4gICAgICAgICAgICAgICAgICBlLFxuICAgICAgICAgICAgICAgICAgcHJvcHMsXG4gICAgICAgICAgICAgICAgICBwYWdlcyxcbiAgICAgICAgICAgICAgICAgIGZvcm1WYWx1ZXMsXG4gICAgICAgICAgICAgICAgICBhY3RpdmVQYWdlLFxuICAgICAgICAgICAgICAgICAgc2V0QWN0aXZlUGFnZSxcbiAgICAgICAgICAgICAgICAgIHNldFBhZ2VDbGlja2VkLFxuICAgICAgICAgICAgICAgICAgc2V0VG91Y2hlZCxcbiAgICAgICAgICAgICAgICAgIHNldFNob3dQYWdlVmFsaWRhdGlvbk1zZ1xuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBjaGVja0NvbmRpdGlvbmFsTG9naWM9eyhjb25kaXRpb24sIGZpZWxkcykgPT5cbiAgICAgICAgICAgICAgICBjaGVja0NvbmRpdGlvbmFsTG9naWMoY29uZGl0aW9uLCAoZmllbGRzID0gZmFsc2UpKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHNhdmVTdGF0ZVRvSHRtbEZpZWxkPXtzYXZlU3RhdGVUb0h0bWxGaWVsZH1cbiAgICAgICAgICAgICAgZW5hYmxlSG9uZXlwb3Q9e2Zvcm1EYXRhLmVuYWJsZUhvbmV5cG90fVxuICAgICAgICAgICAgICBlcnJvcnM9e2Vycm9yTWVzc2FnZXN9XG4gICAgICAgICAgICAgIHVuc2V0RXJyb3I9e2lkID0+IHVuc2V0RXJyb3IoaWQsIGVycm9yTWVzc2FnZXMpfVxuICAgICAgICAgICAgICBkcm9wem9uZVRleHQ9e2Ryb3B6b25lVGV4dH1cbiAgICAgICAgICAgICAgcGFnZUNsaWNrZWQ9e3BhZ2VDbGlja2VkfVxuICAgICAgICAgICAgICBsYW5ndWFnZT17bGFuZ3VhZ2V9XG4gICAgICAgICAgICAgIGFwaUtleXM9e2FwaUtleXN9XG4gICAgICAgICAgICAgIHsuLi5wcm9wc31cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB7KCFmb3JtRGF0YS5wYWdpbmF0aW9uIHx8XG4gICAgICAgICAgICAgIChmb3JtRGF0YS5wYWdpbmF0aW9uICYmIGZvcm1EYXRhLnBhZ2luYXRpb24ucGFnZXMubGVuZ3RoID09PSBhY3RpdmVQYWdlKSkgJiYgKFxuICAgICAgICAgICAgICA8U3VibWl0XG4gICAgICAgICAgICAgICAgQnV0dG9uPXtCdXR0b259XG4gICAgICAgICAgICAgICAgTG9hZGluZz17TG9hZGluZ31cbiAgICAgICAgICAgICAgICBmb3JtRGF0YT17Zm9ybURhdGF9XG4gICAgICAgICAgICAgICAgc3VibWl0SWNvbj17c3VibWl0SWNvbn1cbiAgICAgICAgICAgICAgICBzdWJtaXR0aW5nPXtzdWJtaXR0aW5nfVxuICAgICAgICAgICAgICAgIHByZXZTdGVwPXtlID0+IGhhbmRsZVByZXZTdGVwKGUpfVxuICAgICAgICAgICAgICAgIGxvYWRpbmdTcGlubmVyPXtsb2FkaW5nU3Bpbm5lcn1cbiAgICAgICAgICAgICAgICBoaWRlU3VibWl0QnV0dG9uPXtoaWRlU3VibWl0QnV0dG9ufVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9mb3JtPlxuICAgICAgKSA6IChcbiAgICAgICAgJydcbiAgICAgICl9XG4gICAgPC9HRldyYXBwZXI+XG4gICk7XG59O1xuXG5HcmF2aXR5Rm9ybS5kZWZhdWx0UHJvcHMgPSB7XG4gIHRpdGxlOiB0cnVlLFxuICBzdWJtaXRJY29uOiBmYWxzZSxcbiAgc2F2ZVN0YXRlVG9IdG1sRmllbGQ6IGZhbHNlLFxuICBqdW1wVG9Db25maXJtYXRpb246IHRydWUsXG59O1xuXG5leHBvcnQgeyB2YWxpZGF0ZUZpZWxkLCBGb3JtQ29uZmlybWF0aW9uLCBGb3JtRXJyb3IsIFJlbmRlckZpZWxkcywgU3VibWl0IH07XG5cbmV4cG9ydCBkZWZhdWx0IEdyYXZpdHlGb3JtO1xuXG4iXX0=
"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_isomorphicUnfetch=_interopRequireDefault(require("isomorphic-unfetch")),_index=require("./index");function onSubmit(){return _onSubmit.apply(this,arguments)}function _onSubmit(){return _onSubmit=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function a(b,c,d,e,f,g,h,i,j,k,l,m,n){var o,p,q,r,s,t,u,v,w;return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(o=c.onSubmit,p=new FormData(b.target),b.preventDefault(),q=(0,_index.forceValidation)(e,d,k,l),q){a.next=6;break}return a.abrupt("return",!1);case 6:o?o(p):(g(!0),i(!1),j(!1),m(!1),n(!1),r=c.formID,s=c.backendUrl,t=c.jumpToConfirmation,u=c.onSubmitSuccess,v=c.onError,w=s.substring(0,s.indexOf("/wp-json")),(0,_isomorphicUnfetch["default"])("".concat(w,"/wp-json/gf/v2/forms/").concat(r,"/submissions"),{method:"POST",body:p}).then(function(a){return a.json()}).then(function(a){if(a&&a.is_valid){if(u){var j=u(a);if(!j)return!1}var b=a.confirmation_message,d=b||!1,e=d.type,h=d.link;if(e&&h&&"redirect"===e&&"undefined"!=typeof window)return window.location.replace(h),!1;g(!1),i(!0),m(b),t&&(0,_index.scrollToConfirmation)(c,f)}else throw{response:a}})["catch"](function(a){var b=a&&a.response&&a.response.validation_messages?a.response.validation_messages:"Something went wrong";v?(v(b),g(!1),j(!0)):(g(!1),j(!0),n(b)),t&&(0,_index.scrollToConfirmation)(c,f)}));case 7:case"end":return a.stop();}},a)})),_onSubmit.apply(this,arguments)}var _default=onSubmit;exports["default"]=_default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9IZWxwZXJzL2Zvcm0vb25TdWJtaXRIYW5kbGVyLmpzIl0sIm5hbWVzIjpbIm9uU3VibWl0IiwiZXZlbnQiLCJwcm9wcyIsImZvcm1WYWx1ZXMiLCJhY3RpdmVQYWdlIiwid3JhcHBlclJlZiIsInNldFN1Ym1pdHRpbmciLCJzdWJtaXRTdWNjZXNzIiwic2V0U3VibWl0U3VjY2VzcyIsInNldFN1Ym1pdEZhaWxlZCIsInNldFNob3dQYWdlVmFsaWRhdGlvbk1zZyIsInNldFRvdWNoZWQiLCJzZXRDb25maXJtYXRpb25NZXNzYWdlIiwic2V0RXJyb3JNZXNzYWdlcyIsImN1c3RvbU9uU3VibWl0IiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsInRhcmdldCIsInByZXZlbnREZWZhdWx0IiwiaXNQYWdlVmFsaWQiLCJmb3JtSUQiLCJiYWNrZW5kVXJsIiwianVtcFRvQ29uZmlybWF0aW9uIiwib25TdWJtaXRTdWNjZXNzIiwib25FcnJvciIsImdmU3VibWlzc2lvblVybCIsInN1YnN0cmluZyIsImluZGV4T2YiLCJtZXRob2QiLCJib2R5IiwidGhlbiIsInJlc3AiLCJqc29uIiwicmVzcG9uc2UiLCJpc192YWxpZCIsInJlcyIsImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJjb25maXJtYXRpb25fbWVzc2FnZSIsInR5cGUiLCJsaW5rIiwid2luZG93IiwibG9jYXRpb24iLCJyZXBsYWNlIiwiZXJyb3IiLCJlcnJvck1lc3NhZ2VzIiwidmFsaWRhdGlvbl9tZXNzYWdlcyJdLCJtYXBwaW5ncyI6InljQUdlQSxDQUFBQSxRLCtJQUFmLFdBQ0VDLENBREYsQ0FFRUMsQ0FGRixDQUdFQyxDQUhGLENBSUVDLENBSkYsQ0FLRUMsQ0FMRixDQU1FQyxDQU5GLENBT0VDLENBUEYsQ0FRRUMsQ0FSRixDQVNFQyxDQVRGLENBVUVDLENBVkYsQ0FXRUMsQ0FYRixDQVlFQyxDQVpGLENBYUVDLENBYkYsK0dBZW9CQyxDQWZwQixDQWV1Q1osQ0FmdkMsQ0FlVUYs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QXFHZUwsUSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBmZXRjaCBmcm9tIFwiaXNvbW9ycGhpYy11bmZldGNoXCI7XG5pbXBvcnQgeyBmb3JjZVZhbGlkYXRpb24sIHNjcm9sbFRvQ29uZmlybWF0aW9uIH0gZnJvbSBcIi4vaW5kZXhcIjtcblxuYXN5bmMgZnVuY3Rpb24gb25TdWJtaXQoXG4gIGV2ZW50LFxuICBwcm9wcyxcbiAgZm9ybVZhbHVlcyxcbiAgYWN0aXZlUGFnZSxcbiAgd3JhcHBlclJlZixcbiAgc2V0U3VibWl0dGluZyxcbiAgc3VibWl0U3VjY2VzcyxcbiAgc2V0U3VibWl0U3VjY2VzcyxcbiAgc2V0U3VibWl0RmFpbGVkLFxuICBzZXRTaG93UGFnZVZhbGlkYXRpb25Nc2csXG4gIHNldFRvdWNoZWQsXG4gIHNldENvbmZpcm1hdGlvbk1lc3NhZ2UsXG4gIHNldEVycm9yTWVzc2FnZXNcbikge1xuICBjb25zdCB7IG9uU3VibWl0OiBjdXN0b21PblN1Ym1pdCB9ID0gcHJvcHM7XG4gIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKGV2ZW50LnRhcmdldCk7XG5cbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zdCBpc1BhZ2VWYWxpZCA9IGZvcmNlVmFsaWRhdGlvbihcbiAgICBhY3RpdmVQYWdlLFxuICAgIGZvcm1WYWx1ZXMsXG4gICAgc2V0U2hvd1BhZ2VWYWxpZGF0aW9uTXNnLFxuICAgIHNldFRvdWNoZWRcbiAgKTtcbiAgaWYgKCFpc1BhZ2VWYWxpZCkgcmV0dXJuIGZhbHNlO1xuXG4gIGlmIChjdXN0b21PblN1Ym1pdCkge1xuICAgIGN1c3RvbU9uU3VibWl0KGZvcm1EYXRhKTtcbiAgfSBlbHNlIHtcbiAgICBzZXRTdWJtaXR0aW5nKHRydWUpO1xuICAgIHNldFN1Ym1pdFN1Y2Nlc3MoZmFsc2UpO1xuICAgIHNldFN1Ym1pdEZhaWxlZChmYWxzZSk7XG4gICAgc2V0Q29uZmlybWF0aW9uTWVzc2FnZShmYWxzZSk7XG4gICAgc2V0RXJyb3JNZXNzYWdlcyhmYWxzZSk7XG5cbiAgICBjb25zdCB7IGZvcm1JRCwgYmFja2VuZFVybCwganVtcFRvQ29uZmlybWF0aW9uLCBvblN1Ym1pdFN1Y2Nlc3MsIG9uRXJyb3IgfSA9XG4gICAgICBwcm9wcztcbiAgICBjb25zdCBnZlN1Ym1pc3Npb25VcmwgPSBiYWNrZW5kVXJsLnN1YnN0cmluZyhcbiAgICAgIDAsXG4gICAgICBiYWNrZW5kVXJsLmluZGV4T2YoXCIvd3AtanNvblwiKVxuICAgICk7XG5cbiAgICBmZXRjaChgJHtnZlN1Ym1pc3Npb25Vcmx9L3dwLWpzb24vZ2YvdjIvZm9ybXMvJHtmb3JtSUR9L3N1Ym1pc3Npb25zYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGJvZHk6IGZvcm1EYXRhLFxuICAgIH0pXG4gICAgICAudGhlbihyZXNwID0+IHJlc3AuanNvbigpKVxuICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2UuaXNfdmFsaWQpIHtcbiAgICAgICAgICBpZiAob25TdWJtaXRTdWNjZXNzKSB7XG4gICAgICAgICAgICBjb25zdCByZXMgPSBvblN1Ym1pdFN1Y2Nlc3MocmVzcG9uc2UpO1xuICAgICAgICAgICAgaWYgKCFyZXMpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBjb25maXJtYXRpb25NZXNzYWdlID0gcmVzcG9uc2UuY29uZmlybWF0aW9uX21lc3NhZ2U7XG4gICAgICAgICAgY29uc3QgeyB0eXBlLCBsaW5rIH0gPSBjb25maXJtYXRpb25NZXNzYWdlIHx8IGZhbHNlO1xuICAgICAgICAgIGlmICh0eXBlICYmIGxpbmsgJiYgdHlwZSA9PT0gXCJyZWRpcmVjdFwiKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVwbGFjZShsaW5rKTtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBzZXRTdWJtaXR0aW5nKGZhbHNlKTtcbiAgICAgICAgICBzZXRTdWJtaXRTdWNjZXNzKHRydWUpO1xuICAgICAgICAgIHNldENvbmZpcm1hdGlvbk1lc3NhZ2UoY29uZmlybWF0aW9uTWVzc2FnZSk7XG5cbiAgICAgICAgICBpZiAoanVtcFRvQ29uZmlybWF0aW9uKSB7XG4gICAgICAgICAgICBzY3JvbGxUb0NvbmZpcm1hdGlvbihwcm9wcywgd3JhcHBlclJlZik7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRocm93IHtcbiAgICAgICAgICAgIHJlc3BvbnNlLFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2VzID1cbiAgICAgICAgICBlcnJvciAmJiBlcnJvci5yZXNwb25zZSAmJiBlcnJvci5yZXNwb25zZS52YWxpZGF0aW9uX21lc3NhZ2VzXG4gICAgICAgICAgICA/IGVycm9yLnJlc3BvbnNlLnZhbGlkYXRpb25fbWVzc2FnZXNcbiAgICAgICAgICAgIDogXCJTb21ldGhpbmcgd2VudCB3cm9uZ1wiO1xuXG4gICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgb25FcnJvcihlcnJvck1lc3NhZ2VzKTtcbiAgICAgICAgICBzZXRTdWJtaXR0aW5nKGZhbHNlKTtcbiAgICAgICAgICBzZXRTdWJtaXRGYWlsZWQodHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2V0U3VibWl0dGluZyhmYWxzZSk7XG4gICAgICAgICAgc2V0U3VibWl0RmFpbGVkKHRydWUpO1xuICAgICAgICAgIHNldEVycm9yTWVzc2FnZXMoZXJyb3JNZXNzYWdlcyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoanVtcFRvQ29uZmlybWF0aW9uKSB7XG4gICAgICAgICAgc2Nyb2xsVG9Db25maXJtYXRpb24ocHJvcHMsIHdyYXBwZXJSZWYpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBvblN1Ym1pdDtcbiJdfQ==